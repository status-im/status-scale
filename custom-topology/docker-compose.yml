version: "3"
services:
  bootnode:
    image: ethereum/client-go:alltools-latest
    entrypoint: bootnode
    command: -addr=:30303 -nodekey /keys/bootnode.key
    ports:
      - 30303
    volumes:
      - ./:/keys/:ro
    networks:
      cluster:
        ipv4_address: 172.16.238.10

  central:
    image: status-go:latest
    command:
      - statusd
      - "-les=false"
      - "-shh"
      - "-listenaddr=:30303"
      - "-discovery=true"
      - "-standalone=false"
      - "-stats"
      - "-bootnodes=enode://3f04db09bedc8d85a198de94c84da73aa7782fafc61b28c525ec5cca5a6cc16be7ebbb5cd001780f71d8408d35a2f6326faa1e524d9d8875294172ebec988743@172.16.238.10:30303"
      - "-http"
      - "-httphost=0.0.0.0"
      - "-log=DEBUG"
      - "-maxpeers=25"
      - "-metrics"
    ports:
      - 8080
      - 8545
      - 30303
    networks:
      cluster:
    depends_on:
      - bootnode

  leaf:
    image: status-go:latest
    command:
      - statusd
      - "-les=false"
      - "-shh"
      - "-listenaddr=:30303"
      - "-discovery=false"
      - "-standalone=true"
      - "-stats"
      - "-http"
      - "-httphost=0.0.0.0"
      - "-log=DEBUG"
      - "-maxpeers=3"
      - "-metrics"
    ports:
      - 8080
      - 8545
      - 30303
    networks:
      cluster:
    depends_on:
      - bootnode

networks:
  cluster:
    driver: overlay
    ipam:
      driver: default
      config:
      - subnet: 172.16.238.0/24
